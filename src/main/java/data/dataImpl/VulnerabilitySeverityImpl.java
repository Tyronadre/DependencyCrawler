package data.dataImpl;

import com.google.gson.JsonObject;
import cyclonedx.v1_6.Bom16;
import data.Vulnerability;
import data.VulnerabilitySeverity;
import exceptions.VulnerabilityException;
import us.springett.cvss.Cvss;
import us.springett.cvss.CvssV3;

public class VulnerabilitySeverityImpl implements VulnerabilitySeverity {
    Vulnerability vulnerability;
    JsonObject data;

    public VulnerabilitySeverityImpl(Vulnerability vulnerability, JsonObject data) {
        this.vulnerability = vulnerability;
        this.data = data;
    }

    @Override
    public Bom16.VulnerabilityRating toBom16() {
        return null;
    }

    @Override
    public Double getScore() {
        var cvss = Cvss.fromVector(data.get("score").getAsString());
        if (cvss == null) throw new VulnerabilityException(vulnerability, "Could parse the score");
        return cvss.calculateScore().getBaseScore();
    }
}
