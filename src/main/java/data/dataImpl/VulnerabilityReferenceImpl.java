package data.dataImpl;

import com.google.gson.JsonObject;
import cyclonedx.v1_6.Bom16;
import data.Vulnerability;
import data.VulnerabilityReference;

public class VulnerabilityReferenceImpl implements VulnerabilityReference {
    JsonObject data;
    Vulnerability vulnerability;

    public VulnerabilityReferenceImpl(Vulnerability vulnerability, JsonObject data) {
        this.data = data;
        this.vulnerability = vulnerability;
    }

    @Override
    public String getType() {
        return data.get("type").getAsString();
    }

    @Override
    public String getUrl() {
        return data.get("url").getAsString();
    }

    @Override
    public Bom16.VulnerabilityReference toBom16() {
        var reference = Bom16.VulnerabilityReference.newBuilder();
        reference.setId(vulnerability.getId());
        reference.setSource(Bom16.Source.newBuilder().setName(this.getType()).setUrl(this.getUrl()).build());
        return reference.build();
    }
}
