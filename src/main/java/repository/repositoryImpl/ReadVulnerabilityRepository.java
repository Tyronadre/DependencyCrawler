package repository.repositoryImpl;

import data.Component;
import data.Vulnerability;
import repository.VulnerabilityRepository;

import java.util.ArrayList;
import java.util.List;

public class ReadVulnerabilityRepository implements VulnerabilityRepository {
    List<List<Vulnerability>> vulnerabilities = new ArrayList<>();

    private static ReadVulnerabilityRepository instance;
    public static ReadVulnerabilityRepository getInstance() {
        if (instance == null) {
            instance = new ReadVulnerabilityRepository();
        }
        return instance;
    }

    @Override
    public List<Vulnerability> getVulnerabilities(Component component) {
        throw new UnsupportedOperationException();
    }

    public void addReadVulnerability(Vulnerability vulnerability) {
        vulnerabilities.add(List.of(vulnerability));
    }

    public List<Vulnerability> getAllVulnerabilities() {
        return vulnerabilities.stream().flatMap(List::stream).toList();
    }
}
